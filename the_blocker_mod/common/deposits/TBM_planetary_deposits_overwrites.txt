### The Blocker Mod - Vanilla Overwrites
#
#	Overwrites most keys in 01_blocker_deposits.tx and all keys in 01_planetary_deposits.txt
#	Re-installing those vanilla files will break this mod.
#
#	All terraforming weights are set to should_swap_deposit_on_terraforming - no
#	Otherwise, you will get some very odd planets and district spreads post-terraform.
#	Terraforming in this mod is handled mostly by events.
#
#	AI Weights are set on each feature to allow for greater flexibility.
#	Vanilla inline_script references have been removed so as not to interfere with this.

#	VOID AFTER 0.5
#	Note: For initial release, vanilla features use is_homeworld to re-add lost districts to homeworlds. Otherwise, they start at size 25 with 0 free districts.
#	This will remain the case until a better solution is found (probably involved game_start events) and a compatibility headache.
#	Format below is: 
	# triggered_planet_modifier = {
	# 	potential = {
	# 		is_homeworld = yes
	#		has_planet_flag = lost_colony_homeworld (avoids same on lost colonies)
	# 	}
	# 	modifier = {
	# 		planet_max_district_add = however_many_it_took_away
	# 	}
	# }
#	This only applies to features space effects. You'll still get some nice bonuses, and you can still clear them.
#	Vanilla "blockers" will not spawn on homeworlds, in keeping with vanilla. Who needs mountains?
#	Blockers added at game_start by events will still appear.


### VARIABLES

# 	Spawning

@high = 16
@med = 8
@low = 4
@very_low = 2	# Added by TBM to help with some spawning

@high_rare = 0.5
@mid_rare = 0.25
@low_rare = 0.1

@planet_type_bonus = 1.5	# This is no longer used in TBM but we're keeping it around for sentimental value.

@blocker_high = 10
@blocker_low = 5

# ai_weight variables
# Vanilla defaults to weight = 1 - TBM weights differently for different features and different personalities, colony designations, and some other factors.

@base = 1	# Base ai_weight. AI will clear any feature at weight = 1 *if it needs district space*
@clear = 2	# AI will clear this feature immediately.
@keep = 0	# AI will clear this feature only after all other features of higher weight)
@always_clear = 100	# AI will always clear this feature; used mainly for negative features (e.g., rubble)
@always_keep = -100 # AI will always keep this feature; used mainly for bonus features and some flavor features

#	Resource-related

@ranger_small_production = 0.5
@ranger_large_production = 1



### Blocker Replacement

d_mountain_range = {
	
	category = deposit_cat_blockers_natural

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 950

	resources = {
		category = deposit_blockers_natural
		cost = { 
			energy = 800
		}
	}

	prerequisites = {
		"tech_terrestrial_sculpting"
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 2000
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -3
		district_mining_max = 2
		planet_amenities_mult = 0.05
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_environmentalist }
		}
		planet_rangers_minerals_produces_add = @ranger_large_production
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			is_occupied_flag = yes
		}
		modifier = {
			planet_stability_add = -5	# Guerillas
		}
	}
	
	# For Famous Mountain event, currently disabled
	# triggered_planet_modifier = {
	# 	potential = {
	# 		this = {
	# 			has_deposit_flag = mineral_rights
	# 		}
	# 	}
	# 	modifier = {
	# 		district_mining_max = 2
	# 		planet_miners_minerals_produces_mult = 0.05
	# 	}
	# }

	potential = {
		planet_size > 10
	}

	drop_weight = {
		weight = @very_low

		modifier = {
			factor = 2
			planet_size < 15
			NOT = {
				is_moon = yes
			}
		}

		modifier = {
			factor = 4
			OR = {
				is_planet_class = pc_alpine
				is_planet_class = pc_gaia	
			}		
		}
		modifier = {
			factor = 1.5
			OR = {
				is_planet_class = pc_arid
				is_planet_class = pc_continental	
			}
		}

		modifier = {
			factor = 2
			has_planet_modifier = pm_low_gravity
		}
		modifier = {
			factor = 1.5
			OR = {
				has_hill_feature = yes
				has_mountain_feature = yes
			}
		}

		modifier = {
			factor = 2
			has_planet_modifier = pm_mineral_rich
		}
		modifier = {
			factor = 0.5
			OR = {
				has_planet_modifier = pm_mineral_poor
				has_planet_modifier = pm_asteroid_impacts
			}
		}
		modifier = {
			factor = 0
			has_planet_modifier = pm_high_gravity
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = 0.5
			OR = {
				colony_type = col_mining
			}
		}
		modifier = {
			add = -0.25
			owner = { has_ai_personality = hegemonic_imperialists } # We like imposing scenery.
		}
		modifier = {
			add = -0.25
			owner = { 
				OR = {
					has_ai_personality = erudite_explorers # Landmarks
				}
			}
		}
	}
}

d_active_volcano = {
	category = deposit_cat_blockers_natural

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	blocker_swap_types = {
		d_tempestous_mountain
		d_prosperous_mesa
		d_rich_mountain
		d_fjordland
		d_tropical_island
	}

	time = 720

	prerequisites = {
		"tech_volcano"
	}

	resources = {
		category = deposit_blockers
		cost = {
			energy = 1800
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 200
				engineering_research = 1000
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_generator_max = 1
		planet_jobs_food_produces_mult = 0.1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_volcano }
		}
		modifier = {
			planet_technician_alloys_produces_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_deposit = {
				has_deposit_flag = volcano_erupted	# This has to be applied to a SPECIFIC Active Volcano in the event.
			}
		}
		modifier = {
			district_farming_max = -1
			district_mining_max = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_environmentalist }
		}
		planet_rangers_energy_produces_add = @ranger_large_production
	}

	potential = {
	}

	drop_weight = {
		weight = @blocker_low
		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_alpine
				is_planet_class = pc_savannah
				is_planet_class = pc_ocean
				is_planet_class = pc_nuked
			}
		}
		modifier = {
			factor = 1.5
			OR = {
				is_planet_class = pc_arctic
				is_planet_class = pc_continental
				is_planet_class = pc_tundra
			}
		}
		
		modifier = {
			factor = 2
			OR = {
				planet_size < 15
				has_planet_modifier = pm_low_gravity
			}
		}

		modifier = {
			factor = 2
			has_volcanic_activity = yes
		}
	}

	ai_weight = {
		weight = @clear

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.75
			owner = {
				is_machine_empire = yes
			}
		}

		modifier = {
			add = -0.5
			OR = {
				colony_type = col_generator
			}
		}
	}
}

d_dangerous_wildlife_blocker = {
	category = deposit_cat_blockers_natural

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 120

	resources = {
		category = deposit_blockers_natural
		cost = {
			trigger = {
				num_assigned_jobs = {
					job = dangerous_wildlife_hunter
					value > 2
				}
			}
			energy = -100
		}
		cost = {
			trigger = {
				num_assigned_jobs = {
					job = dangerous_wildlife_poacher
					value >= 2
				}
			}
			energy = -200
		}
		cost = {
			energy = 400
		}
	}

	on_cleared = {
		if = {
			limit = {
				any_owned_pop = {
					has_job = dangerous_wildlife_hunter
				}
				NOT = { owner = { has_technology = tech_dangerous_wildlife }}
			}
			owner = {
				add_resource = {
					food = 200
				}
			}
		}
		
		
		
		# Cull the Herd?
		#planet_event = { id = tbm.5 }	# Disabled for now.
		
		# Chance of Xenofauna Attacks
		hidden_effect = {
			planet = {
				set_timed_planet_flag = {
					flag = settlement_attacked
					years = 1
				}
			}
			random_list = {
				50 = {
					modifier = {
						subtract = 25
						owner = { has_technology = tech_dangerous_wildlife }
					}

					modifier = {
						subtract = 10
						any_owned_pop = {
							has_job = dangerous_wildlife_hunter
						}
					}
					modifier = {
						subtract = 10
						any_owned_pop = {
							has_job = dangerous_wildlife_poacher
						}
					}
					planet_event = {
						id = tbm.17
						days = 30	# Delay is partly for conditional loc, partly because those hunters need some time to report back.
						random = 10
					}
				}
				50 = {
					modifier = {
						add = 25
						owner = { has_technology = tech_dangerous_wildlife }
					}

					modifier = {
						add = 10
						any_owned_pop = {
							has_job = dangerous_wildlife_hunter
						}
					}
					modifier = {
						add = 10
						any_owned_pop = {
							has_job = dangerous_wildlife_poacher
						}
					}
				}
			}
		}
	}

	planet_modifier = {
		planet_researchers_society_research_produces_add = 1
		job_dangerous_wildlife_hunter_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = livestock
			}
		}
		modifier = {
			planet_livestock_food_produces_add = -1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_environmentalist }
		}
		planet_rangers_society_research_produces_add = @ranger_large_production
	}

	potential = {
	}

	drop_weight = {
		weight = @blocker_high
		
		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_continental
				is_planet_class = pc_tropical
				is_planet_class = pc_nuked
				}
		}
		modifier = {
			factor = 1.5
			OR = {
				is_planet_class = pc_arctic
				is_planet_class = pc_savannah
			}
		}

		modifier = {
			factor = 0.5
			is_planet_class = pc_gaia
		}
		
		modifier = {
			factor = 2
			OR = {
				has_deposit = d_dense_jungle
				has_deposit = d_rugged_woods
				has_deposit = d_lush_jungle
			}
		}
		modifier = {
			factor = 2
			OR = {
				has_planet_modifier = pm_dangerous_wildlife
				has_planet_modifier = pm_titanic_life
			}
		}
		
	}

	ai_weight = {
		weight = @clear

		inline_script = tbm_personality_weights
	inline_script = tbm_designation_weights

		modifier = {
			add = -0.5
			owner = {
				OR = {
					is_machine_empire = yes
					is_hive_empire = yes
					is_homicidal = yes
				}
			}
		}
	}
}

d_dense_jungle = {
	category = deposit_cat_blockers_natural

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 720

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 500
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 500
				food = 200
				consumer_goods = 50
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -2
		planet_jobs_food_produces_mult = 0.05
		planet_researchers_society_research_produces_add = 2
		planet_amenities_add = 2
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_food_produces_add = 3
			planet_colonist_society_research_produces_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_environmentalist }
		}
		planet_rangers_food_produces_add = @ranger_small_production
	}

	potential = {
		OR = {
			is_wet = yes
			is_planet_class = pc_gaia
		}
		is_homeworld = no
		NOT = { has_planet_flag = lost_colony_homeworld }
	}
	
	drop_weight = {
		weight = @med
		
		modifier = {
			factor = 4
			planet_size > 20
		}
		modifier = {
			factor = 2
			planet_size > 15
		}
		modifier = {
			factor = 0.5
			planet_size < 13
		}

		modifier = {
			factor = 5
			is_planet_class = pc_tropical
		}
		modifier = {
			factor = 4
			is_planet_class = pc_gaia
		}
		modifier = {
			factor = 2.5
			OR = {
				is_planet_class = pc_continental
				is_planet_class = pc_ocean
			}
		}
		modifier = {
			factor = 5
			has_planet_modifier = pm_lush
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.5
			owner = {
				OR = {
					has_ai_personality = erudite_explorers
					has_ai_personality = federation_builders
					has_ai_personality = migrating_flock
					has_ai_personality = harmonious_hierarchy
					has_ai_personality = spiritual_seekers
					has_ai_personality = hive_mind
				}
			}
		}

		modifier = {
			add = 0.5
			owner = {
				OR = {
					has_ai_personality = ruthless_capitalists
					has_ai_personality = machine_intelligence
					has_ai_personality = exterminators
					has_ai_personality = devouring_swarm
				}
			}
		}
		
		modifier = {
			add = -0.6
			colony_type = col_research
		}

		modifier = {
			add = -0.25
			colony_type = col_farming
		}

		modifier = {
			add = -0.33
			owner_species = {
				has_trait = trait_plantoid_budding
			}
		}

		modifier = {
			add = 0.33
			owner_species = {
				has_trait = trait_plantoid_phototrophic
			}
		}
	}
}

d_toxic_kelp = {
	category = deposit_cat_blockers_natural

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	prerequisites = { "tech_toxic_kelp" }

	time = 60

	resources = {
		category = deposit_blockers_natural
		cost = {
			trigger = {
				exists = owner
				owner = { has_trait = trait_aquatic	}
			}
			energy = 200
		}
		cost = {
			energy = 500
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				society_research = 200
			}
		}
	}

	planet_modifier = {
		trade_value_mult = -0.05
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_food_produces_add = 1
			planet_colonist_society_research_produces_add = 1
			planet_colonist_physics_research_produces_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_trait = trait_aquatic
			}
		}
		modifier = {
			planet_jobs_food_produces_mult = -0.05	
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_environmentalist }
		}
		planet_rangers_food_produces_add = @ranger_small_production
	}

	potential = {
		OR = {
			is_planet_class = pc_ocean
			is_planet_class = pc_continental
			is_planet_class = pc_gaia
		}
	}

	drop_weight = {
		weight = @blocker_high
		modifier = {
			factor = 4
			is_planet_class = pc_ocean
		}
		modifier = {
			factor = 0.5
			OR = {
				is_planet_class = pc_tropical
				is_planet_class = pc_gaia
				is_planet_class = pc_nuked
			}
		}
		modifier = {
			factor = 0
			is_dry = yes
			is_planet_class = pc_tundra
			is_planet_class = pc_alpine
		}

		modifier = {
			factor = 2
			has_deposit = d_tropical_island
		}
	}

	ai_weight = {
		weight = @clear

		# No archetypes here; even the Spiritual Seekers don't love Toxic Kelp

		modifier = {
			add = -0.5
			any_owned_pop = {
				has_job = colonist
			}
		}
	}
}

d_deep_sinkhole = {
	category = deposit_cat_blockers_natural

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 60

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 200
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 500
			}
		}
		
		# Clearing sinkholes sometimes makes other sinkholes.
		random_list = {
			33 = {
				set_planet_flag = occasional_sinkholes
			}
			66 = {}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_mining_max = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_minerals_produces_add = 2
			planet_colonist_engineering_research_produces_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_environmentalist }
		}
		planet_rangers_energy_produces_add = @ranger_small_production
	}

	potential = {
		is_homeworld = no
		NOT = { has_planet_flag = lost_colony_homeworld }
	}

	drop_weight = {
		weight = @blocker_low
		modifier = {
			factor = 2
			OR = {
				is_dry = yes
				is_planet_class = pc_alpine
			}
		}
		modifier = {
			factor = 0.5
			OR = {
				has_climate = wet
				is_planet_class = pc_arctic
				is_planet_class = pc_gaia
				is_planet_class = pc_nuked
			}
		}
		modifier = {
			factor = 0
			is_planet_class = pc_ocean
		}

		modifier = {
			factor = 4
			OR = {
				has_deposit = d_sandsea
				has_deposit = d_quicksand_basin
			}
		}
	}

	ai_weight = {
		weight = @clear	# Most sinkhole bonuses are via event, better for player

		modifier = {
			add = -0.4
			OR = {
				colony_type = col_mining
				colony_type = col_rural
			}
		}
	}
}

d_quicksand_basin = {
	category = deposit_cat_blockers_natural

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 270

	prerequisites = { "tech_noxious_swamp" }

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 650
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 500
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		planet_miners_minerals_produces_mult = 0.05
		pop_happiness = -0.05
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_physics_research_produces_add = 1
			planet_colonist_engineering_research_produces_add = 1
		}
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_noxious_swamp }
		}
		modifier = {
			planet_miners_minerals_produces_mult = 0.05
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_quicksand_basin }
		}
		modifier = {
			planet_farmers_food_produces_mult = 0.05
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_environmentalist }
		}
		planet_rangers_minerals_produces_add = @ranger_small_production
	}

	drop_weight = {
		weight = @blocker_high
		modifier = {
			factor = 2
			OR = {
				is_dry = yes
				is_planet_class = pc_ocean
			}
		}
		modifier = {
			factor = 1.5
			OR = {
				is_planet_class = pc_tropical
				is_planet_class = pc_continental
				is_planet_class = pc_tundra
			}
		}
		modifier = {
			factor = 0.5
			OR = {
				is_planet_class = pc_gaia
				is_planet_class = pc_nuked
			}
		}
		modifier = {
			factor = 0
			is_planet_class = pc_alpine
		}

		modifier = {
			factor = 4
			has_deposit = d_sandsea
		}
	}

	ai_weight = {
		weight = @clear

		modifier = {
			add = -0.4
			OR = {
				colony_type = col_mining
				colony_type = col_rural
			}
		}
	}
}

d_noxious_swamp = {
	category = deposit_cat_blockers_natural
	
	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	prerequisites = { "tech_noxious_swamp" }

	time = 240

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 600
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				society_research = 400
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		pop_amenities_usage_mult = 0.1
		planet_researchers_society_research_produces_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_food_produces_add = 5
			planet_colonist_society_research_produces_add = 1
			planet_colonist_engineering_research_produces_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_environmentalist }
		}
		planet_rangers_food_produces_add = @ranger_small_production
	}

	drop_weight = {
		weight = @blocker_high
		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_tundra
				is_wet = yes
			}
		}
		modifier = {
			factor = 2
			is_planet_class = pc_tropical
		}
		modifier = {
			factor = 1.5
			OR = {
				is_planet_class = pc_alpine
				is_planet_class = pc_arctic
			}
		}
		modifier = {
			factor = 0.5
			OR = {
				has_climate = dry
				is_planet_class = pc_gaia
			}
		}
		modifier = {
			factor = 0
			num_free_districts = {
				type = district_city
				value < 2
			}
		}
	}

	ai_weight = {
		weight = @clear

		modifier = {
			add = -0.15
			any_owned_pop = {
				has_job = colonist
			}
		}

		modifier = {
			add = -0.4
			colony_type = col_research
		}
	}
}

d_massive_glacier = {
	category = deposit_cat_blockers_natural

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	prerequisites = { "tech_massive_glacier" }

	time = 1800

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 3500
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 1000
			}
		}

		# Climate Control Network Malfunctions
		inline_script = climate_control_activate
	}

	planet_modifier = {
		planet_max_districts_add = -3
		planet_miners_minerals_produces_mult = 0.05
		planet_researchers_engineering_research_produces_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_minerals_produces_add = 1
			planet_colonist_engineering_research_produces_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_civic = civic_environmentalist }
		}
		planet_rangers_minerals_produces_add = @ranger_small_production
	}

	potential = {
	}

	drop_weight = {
		weight = @very_low
		modifier = {
			factor = 10
			is_planet_class = pc_arctic
		}
		modifier = {
			factor = 4
			OR = {
				is_planet_class = pc_alpine
				is_planet_class = pc_tundra
				is_planet_class = pc_continental
			}
		}
		modifier = {
			factor = 2
			is_planet_class = pc_gaia
		}
		modifier = {
			factor = 0.5
			OR = {
				is_planet_class = pc_arid
				is_planet_class = pc_ocean
				is_planet_class = pc_tropical
			}
		}
		modifier = {
			factor = 0
			OR = {
				is_planet_class = pc_desert
				is_planet_class = pc_savannah
				is_planet_class = pc_nuked
			}
		}

		modifier = {
			factor = 2
			OR = {
				has_deposit = d_mountain_range
				has_deposit = d_fjordland
			}
		}
	}

	ai_weight = {
		weight = @clear

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights
		
		modifier = {
			add = -0.5	# These are pretty good mining features but they're also space-killers, so AI should still clear
			colony_type = col_mining
		}
		
		modifier = {
			add = -1000
			owner = {
				has_civic = civic_environmentalist
			}
		}
	}
}

# These are cloned and added via generate_start_deposits_and_blockers to avoid some bugs.
# Main difference is these no longer have blocker_swap_types and so will no longer add random features to block on your homeworld.
# If you really want 'em back, de-comment blocker_swap_types below, but be aware you may end up with negative starting districts on your homeworld in some cases.
d_vanilla_failing_infrastructure = {
	icon = d_metal_boneyard
	time = 120

	is_for_colonizable = yes
	category = deposit_cat_blockers

	potential = { always = no }

	planet_modifier = {
		planet_max_districts_add = -1
	}

	#use_weights_for_blocker_swap_types = yes
	# blocker_swap_types = {
	# 	d_rushing_waterfalls
	# 	d_searing_desert
	# 	d_frozen_gas_lake
	# 	d_prosperous_mesa
	# 	d_ore_rich_caverns
	# 	d_fungal_caves
	# 	d_lush_jungle
	# 	d_fertile_lands
	# 	d_great_river
	# }

	resources = {
		category = deposit_blockers
		cost = {
			energy = 300
		}
	}

	ai_weight = {
		weight = @clear		# This should help the AI get rid of these a bit faster. The vanilla clone doesn't actually have any ill effects, but it's still weird to conquer planets that have this still around.
	}
}

### TOMB

d_radioactive_wasteland = {
	category = deposit_cat_blockers

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 720

	resources = {
		category = deposit_blockers
		cost = {
			energy = 2000
		}
	}

	planet_modifier = {
		planet_max_districts_add = -2
		planet_researchers_physics_research_produces_mult = 0.05
		pop_happiness_negative = 0.1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_physics_research_produces_add = 2
		}
	}

	potential = {
		is_planet_class = pc_nuked
		is_homeworld = no	# These are added by script for special homeworlds that need 'em.'
		NOT = { has_planet_flag = lost_colony_homeworld }
	}

	drop_weight = {
		weight = @blocker_high
		modifier = {
			factor = 5	# Not spawning enough on Tomb Worlds with other custom features.
			is_planet_class = pc_nuked
		}
	}

	ai_weight = {
		weight = @clear

		modifier = {
			add = -0.75		# These get very little other reason to be kept around so should still go.
			any_owned_pop = {
				has_job = colonist
			}
		}

		modifier = {
			add = -0.5
			colony_type = col_research
		}

		modifier = {
			add = 1		# Except for the crazies; they like basking in the glow, at least for a while.
			owner = {
				has_ai_personality = exterminators
				has_ai_personality = metalhead
			}
		}
	}
}

d_city_ruins = {
	category = deposit_cat_blockers

	use_for_min_max_adjustments = yes
	is_for_colonizable = yes

	should_swap_deposit_on_terraforming = no

	time = 480

	resources = {
		category = deposit_blockers
		cost = {
			energy = 1200
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		planet_researchers_society_research_produces_mult = 0.05
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_society_research_produces_add = 2
		}
	}

	potential = {
		OR = {
			is_planet_class = pc_nuked
			is_planet_class = pc_relic
		}
	}

	drop_weight = {
		weight = @blocker_high
		
		modifier = {
			factor = 2	# Mostly so it doesn't get crowded out by custom features.
			is_planet_class = pc_nuked
		}
	}

	ai_weight = {
		weight = @clear

		modifier = {
			add = -1.25
			owner = {
				OR = {
					has_ai_personality = spiritual_seekers
					has_ai_personality = fanatic_befrienders
				}
			}
		}

		modifier = {
			add = -0.75
			colony_type = col_research
		}
	}
}

d_bomb_crater = {
	icon = d_crater
	category = deposit_cat_blockers

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes
	
	should_swap_deposit_on_terraforming = no

	time = 360

	resources = {
		category = deposit_blockers
		cost = {
			energy = 1200
			minerals = 500
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_mining_max = 1
		planet_researchers_engineering_research_produces_add = 2
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_minerals_produces_add = 5
		}
	}

	potential = {
		is_planet_class = pc_nuked
	}

	drop_weight = {
		weight = @blocker_low
		
		modifier = {
			factor = 4	# Mostly to prevent these getting swamped by custom features.
			is_planet_class = pc_nuked
		}
		
		# Vanilla
		modifier = {
			factor = 0
			num_free_districts = {
				type = district_city
				value < 2
			}
		}
	}

	ai_weight = {
		weight = @clear

		modifier = {
			add = -0.5
			OR = {
				colony_type = col_research
				colony_type = col_mining
			}
		}

		modifier = {
			add = 1		# Except for the crazies; they like basking in the glow, at least for a while.
			owner = {
				has_ai_personality = exterminators
				has_ai_personality = metalhead
			}
		}		
	}
}

###############
#### ENERGY ###
###############

d_arid_highlands = {
	category = deposit_cat_energy

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes
	
	should_swap_deposit_on_terraforming = no

	prerequisites = { "tech_mountain_range" }

	time = 1260

	resources = {
		category = deposit_blockers_natural
		produces = {
			trigger = {
				has_planet_flag = desert_strong
			}
			unity = 1
		}
		cost = {
			energy = 800
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 500
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -2
		district_generator_max = 1
		planet_buildings_upkeep_mult = 0.05
	}

	triggered_planet_modifier = {
		potential = {
			OR = {
				has_planet_modifier = pm_hazardous_weather
				has_planet_modifier = pm_wild_storms
			}
		}
		modifier = {
			district_generator_max = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_generator_max = 1
		mult = value:district_amount_mastery_of_nature
	}
	
	# From A City of the Desert Chain
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_modifier = waters_of_life
			}
		}
		modifier = {
			planet_jobs_food_produces_mult = 0.05
			district_farming_max = 1
		}
	}

	potential = {
		OR = {
			is_dry = yes
			is_planet_class = pc_gaia
			is_planet_class = pc_nuked
		}
	}

	drop_weight = {
		weight = @med
		modifier = {
			factor = 5
			is_planet_class = pc_arid
		}
		modifier = {
			factor = 2
			OR = {
				is_cold = yes
				is_wet = yes
				is_planet_class = pc_desert
				is_planet_class = pc_savannah
			}
		}
		modifier = {
			factor = 0
			is_planet_class = pc_tropical
		}

		modifier = {
			factor = 2
			has_hill_feature = yes
		}
	}
	
	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.5
			colony_type = col_mining
		}

		modifier = {
			add = -2 # Never clear
			OR = {
				owner = {
					has_modifier = waters_of_life
				}
				planet = {
					has_planet_flag = desert_strong
				}
			}
		}
	}
}

d_hot_springs = {
	category = deposit_cat_energy

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 90

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 600
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				society_research = 500
			}
		}
		hidden_effect = {
			add_modifier = {
				modifier = cleared_hot_springs
				years = 10
			}
		}
		add_deposit = d_geothermal_power_plant
	}

	planet_modifier = {
		planet_max_districts_add = -1
		planet_amenities_add = 10
		# Should also add spa building or possibly call spa event.
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_society_research_produces_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_generator_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	drop_weight = {
		weight = @low
		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_tundra
				is_planet_class = pc_alpine
			}
		}
		modifier = {
			factor = 1.5
			OR = {
				is_planet_class = pc_continental
				is_planet_class = pc_ocean
			}
		}
		modifier = {
			factor = 0.5
			is_planet_class = pc_nuked
		}
		modifier = {
			factor = 0
			is_planet_class = pc_savannah
		}

		modifier = {
			factor = 2
			has_volcanic_activity = yes
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -2	# Do not clear baths on unity worlds
			OR = {
				colony_type = col_bureau
				colony_type = col_bureau_hive
				colony_type = col_bureau_hive
				colony_type = col_bureau_machine
			}
		}

		modifier = {
			add = -2
			free_amenities < 10
		}
	}
}

d_rushing_waterfalls = {
	category = deposit_cat_energy

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 480

	resources = {
		category = deposit_blockers_natural
		produces = {
			unity = 2
		}
		cost = {
			energy = 800
		}
	}

	on_cleared = {	
		add_deposit = d_hydro_plant
		hidden_effect = {
			add_deposit = d_floodplains
			random_list = {
				50 = {
					add_deposit = d_floodplains
				}
				50 = {}
			}
		}
	}

	planet_modifier = {
		planet_amenities_add = 5
		pop_happiness = 0.05
		planet_clerks_unity_produces_add = 0.25
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_unity_produces_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_generator_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	drop_weight = {
		weight = @low
		modifier = {
			factor = 4
			OR = {
				is_planet_class = pc_tropical
				is_planet_class = pc_ocean
			}
		}
		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_continental
				is_planet_class = pc_tundra
				is_planet_class = pc_alpine
				is_planet_class = pc_gaia
			}
		}
		modifier = {
			factor = 0.25
			is_planet_class = pc_nuked
		}
		modifier = {
			factor = 0
			OR = {
				is_planet_class = pc_savannah
				is_planet_class = pc_desert
			}
		}

		modifier = {
			factor = 2
			OR = {
				has_deposit = d_great_river
				has_deposit = d_mountain_range
				has_mountain_feature = yes
			}
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -1
			owner = {
				has_ai_personality = spiritual_seekers	# Sacred Water
				has_ai_personality = hegemonic_imperialists	# We like imposing things.
				has_ai_personality = erudite_explorers	# Got things to see.
				has_ai_personality = harmonious_hierarchy
				has_ai_personality = fanatic_befrienders	# Nights beneath the waterfall are romantic in most societies
			}
		}
		
		modifier = {
			add = -2	# Do not clear waterfalls on unity worlds
			OR = {
				colony_type = col_bureau
				colony_type = col_bureau_hive
				colony_type = col_bureau_hive
				colony_type = col_bureau_machine
			}
		}

		modifier = {
			add = -0.75
			free_amenities < 5
		}
	}
}

d_searing_desert = {
	category = deposit_cat_energy

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	can_be_cleared = {
		NOR = {
			owner = {
				NOR = {
					has_country_flag = desert_cities
					has_modifier = waters_of_life
					has_modifier = great_desert_city
				}
			}
			planet = {
				OR = {
					has_modifier = bringing_water
					has_modifier = dream_city
				}
			}
		}
		owner = {
			OR = {
				has_technology = tech_housing_2
				has_technology = tech_terrestrial_sculpting
			}
		}
	}

	time = 7200

	resources = {
		category = deposit_blockers_natural
		produces = {
			trigger = {
				has_planet_flag = desert_strong
			}
			unity = 1
		}
		cost = {
			energy = 1800
		}
	}

	planet_modifier = {
		planet_max_districts_add = -3
		district_generator_max = 1
		planet_technician_energy_produces_mult = 0.2
		planet_buildings_energy_upkeep_mult = 0.1
	}
	
	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_generator_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	# From A City of the Desert Chain
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_modifier = waters_of_life
			}
		}
		modifier = {
			planet_jobs_food_produces_mult = 0.05
			district_farming_max = 1
		}
	}

	potential = {
		NOR = {
			is_planet_class = pc_ocean
			is_planet_class = pc_tropical
			is_cold = yes
		}
	}

	drop_weight = {
		weight = @very_low
		
		modifier = {
			factor = 4
			planet_size > 20
		}
		modifier = {
			factor = 2
			planet_size > 15
		}
		modifier = {
			factor = 0.5
			planet_size < 13
		}
		
		modifier = {
			factor = 5
			OR = {
				is_planet_class = pc_desert
				is_planet_class = pc_nuked
			}
		}
		modifier = {
			factor = 2
			is_dry = yes
		}
		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_continental
			}
		}
		modifier = {
			factor = 0.25
			is_planet_class = pc_gaia
		}
		modifier = {
			factor = 0
			OR = {
				is_planet_class = pc_ocean
				is_planet_class = pc_tropical
				is_cold = yes
			}
		}
	}

	ai_weight = {
		weight = @clear

		modifier = {
			add = -0.25 	# Slight boost, but this is still a space killer, so we want to clear it soon even on generator worlds.
			colony_type = col_generator
		}

		modifier = {
			add = -2 	# However, keep it if we're on a generator world and we're trying to build more generators
			colony_type = col_generator
			num_free_districts = {
				type = district_generator
				value < 1
			}
		}
	}
}

d_frozen_gas_lake = {
	category = deposit_cat_energy

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 180

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 600
			minerals = 300
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				exotic_gases = 50
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_generator_max = 1
		planet_technician_energy_produces_mult = 0.05
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_food_produces_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_generator_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	drop_weight = {
		weight = @low
		modifier = {
			factor = 2
			is_cold = yes
		}
		modifier = {
			factor = 2
			OR = {
				has_deposit = d_bubbling_swamp
				has_deposit = d_fuming_bog
			}
		}
		modifier = {
			factor = 0
			OR = {
				is_dry = yes
				is_planet_class = pc_tropical
				is_planet_class = pc_gaia
			}
		}

		modifier = {
			factor = 2
			has_volcanic_activity = yes
		}
		modifier = {
			factor = 2
			OR = {
				has_deposit = d_bubbling_swamp
				has_deposit = d_fuming_bog
			}
		}
		modifier = {
			factor = 2
			has_gaseous_system = yes	# Checks if there's any exotic gas in the system.
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights
		
		modifier = {
			add = -0.5
			colony_type = col_generator
		}

		modifier = {
			add = 1	# Clear this if we don't have gases, or are running a deficit and will need the +50. Ideally, this should help AIs get a bit mor SRs.
			owner = {
				OR = {
					resource_income_compare = {
						resource = exotic_gases
						value < 0
					}
					has_country_resource = {
						type = exotic_gases
						amount = 0
					}
				}
			}
		}
	}
}

d_geothermal_vent = {
	category = deposit_cat_energy

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 920

	resources = {
		category = deposit_blockers_natural
		
		cost = {
			trigger = {
				NOT = { 
					owner = { has_technology = tech_volcano }
				}
			}
			energy = 600
			engineering_research = 200
		}

		cost = {
			energy = 600
			minerals = 200
		}
		
		produces = {
			trigger = {
				has_modifier = studying_latent_underlying_geothermal_gas_eruption_rhythm
			}
			engineering_research = 2
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_generator_max = 1
		planet_technician_energy_produces_mult = 0.05
		planet_researchers_engineering_research_produces_add = 2
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_engineering_research_produces_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_generator_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	drop_weight = {
		weight = @med
		modifier = {
			factor = 2
			is_cold = yes
		}
		modifier = {
			factor = 0.5
			OR = {
				is_planet_class = pc_tropical
				is_planet_class = pc_savannah
				is_planet_class = pc_nuked
			}
		}
		modifier = {
			factor = 0
			is_dry = yes
		}
		modifier = {
			add = 5		### Add is deliberate! Won't spawn on dry worlds UNLESS they have volcanic activity.
			has_volcanic_activity = yes
		}
	}

	ai_weight = {
		weight = @base
		
		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.5
			OR = {
				colony_type = col_generator
				colony_type = col_research
			}
		}
	}
}

d_underwater_vent = {
	category = deposit_cat_energy

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 1260

	resources = {
		category = deposit_blockers_natural
		produces = {
			trigger = {
				has_modifier = studying_latent_underlying_geothermal_gas_eruption_rhythm
			}
			engineering_research = 2
		}
		cost = {
			trigger = {
				owner = {
					NOT = { has_trait = trait_aquatic }
				}
			}
			energy = 1000
			minerals = 600
		}
		cost = {
			trigger = {
				owner = { has_trait = trait_aquatic	}
			}
			energy = 600
			minerals = 1000
		}
	}

	planet_modifier = {
		district_generator_max = 1
		trade_value_mult = -0.1
		planet_researchers_engineering_research_produces_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_generator_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_energy_produces_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_trait = trait_aquatic }
		}
		modifier = {
			planet_max_districts_add = -2
			district_generator_max = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_origin = origin_ocean_paradise }
			is_homeworld = yes
		}
		modifier = {
			trade_Value_mult = 0.1
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_technology = tech_volcano
			}
		}
		modifier = {
			district_generator_max = 1
		}
	}

	potential = {
		OR = {
			is_planet_class = pc_continental
			is_planet_class = pc_ocean
			is_planet_class = pc_arctic
			is_planet_class = pc_gaia
		}
	}
	
	drop_weight = {
		weight = @high

		modifier = {
			factor = 2
			has_volcanic_activity = yes
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = 1
			NOT = { is_homeworld = yes }
			owner = { has_trait = trait_aquatic }
		}

		modifier = {
			add = -0.5	# Should result in Aquatics treating these as basically normal blockers but only on generator worlds. Otherwise, they want the space.
			OR = {
				colony_type = col_generator
				colony_type = col_research
			}
		}
	}
}

d_tempestous_mountain = {
	category = deposit_cat_energy

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 720

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 1500
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 1000
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -2
		planet_amenities_add = 5
		district_mining_max = 1
		district_farming_max = 1
		district_generator_max = 1
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_generator_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_unity_produces_add = 2
		}
	}

	drop_weight = {
		weight = @blocker_high
		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_alpine
				is_planet_class = pc_continental
				is_planet_class = pc_ocean
			}
		}
		modifier = {
			factor = 0
			OR = {
				is_planet_class = pc_savannah
				is_planet_class = pc_desert
				is_planet_class = pc_arctic
			}
		}
		modifier = {
			factor = 5
			has_mountain_feature = yes
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.5
			OR = {
				colony_type = col_farming
				colony_type = col_mining
				colony_type = col_generator
			}
		}

		modifier = {
			add = -0.5
			owner = {
				is_industrialist = yes
			}
		}

		modifier = {
			add = -0.5
			owner = {
				has_origin = origin_subterranean
			}
		}
	}
}

###################
#### MINERALS #####
###################

d_veiny_cliffs = {
	category = deposit_cat_minerals

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 270

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 500
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 500
				engineering_research = 100
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_mining_max = 1
		planet_miners_minerals_produces_mult = 0.05
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_minerals_produces_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_mining_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	drop_weight = {
		weight = @med
		
		modifier = {
			factor = 2
			planet_size < 15
		}
		
		modifier = {
			factor = 4
			OR = {
				is_planet_class = pc_ocean
				is_planet_class = pc_alpine
			}
		}
		modifier = {
			factor = 2
			is_planet_class = pc_continental
		}
		modifier = {
			factor = 0
			OR = {
				is_planet_class = pc_tropical
				is_planet_class = pc_savannah
			}
		}

		modifier = {
			factor = 4
			has_mountain_feature = yes
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.75	# These are upper-end mining features as they don't hit amenities
			colony_type = col_mining
		}

		modifier = {
			add = -0.25
			owner = {
				OR = {
					is_industrialist = yes
					has_ai_personality = slaving_despots
					has_ai_personality = hegemonic_imperialists
					has_ai_personality = ruthless_capitalists
				}
			}
		}
	}
}

d_mineral_fields = {
	category = deposit_cat_minerals

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 90

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 500
		}
		cost = {
			trigger = {
				owner = { has_technology = tech_mountain_range }
			}
			energy = -250
		}
		cost = {
			trigger = {
				owner = { has_technology = tech_terrestrial_sculpting }
			}
			energy = -250
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 500
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_mining_max = 1
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_mining_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_minerals_produces_add = 2
		}
	}

	drop_weight = {
		weight = @med
		modifier = {
			factor = 2
			OR = {
				is_cold = yes
			}
		}
		modifier = {
			factor = 0.5
			is_planet_class = pc_ocean
		}
		modifier = {
			factor = 0
			is_planet_class = pc_tropical
		}

		modifier = {
			factor = 6
			OR = {
				has_planet_modifier = pm_asteroid_impacts
				has_planet_modifier = pm_asteroid_belt
				has_planet_modifier = pm_mineral_rich
				has_deposit = d_crater
			}
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.75	# These are upper-end mining features as they don't hit amenities
			colony_type = col_mining
		}

		modifier = {
			add = -0.25
			owner = {
				OR = {
					is_industrialist = yes
					has_ai_personality = slaving_despots
					has_ai_personality = hegemonic_imperialists
					has_ai_personality = ruthless_capitalists
				}
			}
		}
	}
}

d_prosperous_mesa = {
	category = deposit_cat_minerals

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	can_be_cleared = {
		owner = {
			oR = {
				has_technology = tech_mountain_range
				has_technology = tech_terrestrial_sculpting
			}
		}
	}

	time = 1800

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 1500
		}
		cost = {
			trigger = {
				owner = { has_technology = tech_mountain_range }
			}
			energy = -500
		}
		cost = {
			trigger = {
				owner = { has_technology = tech_terrestrial_sculpting }
			}
			energy = -500
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 1000
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -2
		district_generator_max = 1
		district_mining_max = 1
		district_farming_max = 1
		planet_priests_unity_produces_mult = 0.1
		pop_housing_usage_mult = 0.1
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_mining_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	potential = {
		OR = {
			is_planet_class = pc_continental
			is_planet_class = pc_tropical
			is_planet_class = pc_savannah
			is_planet_class = pc_desert
			is_planet_class = pc_gaia
			is_planet_class = pc_relic
		}
	}

	drop_weight = {
		weight = @blocker_low
		modifier = {
			factor = 2
			is_planet_class = pc_savannah
		}
		modifier = {
			factor = 0.5
			OR = {
				is_planet_class = pc_desert
				is_planet_class = pc_tundra
				is_planet_class = pc_alpine
			}
		}
		modifier = {
			factor = 0
			is_planet_class = pc_ocean
		}
		modifier = {
			factor = 2
			has_mountain_feature = yes
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -1
			owner = {
				has_ai_personality = spiritual_seekers
				has_ai_personality = evangelising_zealots	# Preach from the mount.
			}
		}

		modifier = {
			add = -0.25
			owner = {
				has_ai_personality = hegemonic_imperialists # We just like imposing things.
			}
		}
	}
}

d_ore_rich_caverns = {
	category = deposit_cat_minerals

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 270

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 600
			engineering_research = 50
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 800
			}
		}
	}

	planet_modifier = {
		district_mining_max = 2
		planet_miners_minerals_produces_mult = -0.05
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_minerals_produces_add = 1
		}
	}

	### Snazzy option to randomly add extra districts for variation, but potential performance hit?
	#	Also requires further testing.
	# triggered_planet_modifier = {
	# 	potential = {
	# 		check_variable_arithmetic = {
	# 			which = @random_feature
	# 			value = value:random_feature_value
	# 		}
	# 	}
	# 	modifier = {
	# 		district_mining_max = 1
	# 	}
	# }

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_origin = origin_subterranean
			}
		}
		modifier = {
			planet_miners_minerals_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_mining_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	drop_weight = {
		weight = @high

		# Should be a boost here for other subterranean features but we don't have enough of them yet.
	}

	ai_weight = {
		weight = @keep

		modifier = {
			add = -0.5
			owner = {
				is_industrialist = yes
			}
		}

		modifier = {
			add = -0.5
			owner = {
				has_origin = origin_subterranean
			}
		}
	}
}

d_rich_mountain = {
	category = deposit_cat_minerals

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 720
	
	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 1500
		}
		cost = {
			trigger = {
				owner = { has_technology = tech_mountain_range }
			}
			energy = -500
		}
		cost = {
			trigger = {
				owner = { has_technology = tech_terrestrial_sculpting }
			}
			energy = -500
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 1000
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -2
		district_mining_max = 2
		district_farming_max = 1
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_mining_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_minerals_produces_add = 1
		}
	}

	drop_weight = {
		weight = @low
		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_tundra
				is_planet_class = pc_continental
				is_planet_class = pc_ocean
			}
		}
		modifier = {
			factor = 0.5
			OR = {
				is_planet_class = pc_alpine
				is_planet_class = pc_arid
				is_planet_class = pc_arctic
			}
		}
		modifier = {
			factor = 0
			OR = {
				is_planet_class = pc_desert
				is_planet_class = pc_savannah
				is_planet_class = pc_tropical
				is_planet_class = pc_nuked
			}
		}

		modifier = {
			factor = 4
			OR = {
				has_planet_modifier = pm_mineral_rich
				has_planet_modifier = pm_ultra_rich
			}
		}
	}

	ai_weight = {
		weight = @keep

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.75
			OR = {
				colony_type = col_mining
				colony_type = col_farming
			}
		}

		modifier = {
			add = -0.25
			owner = {
				has_ai_personality = hegemonic_imperialists # We just like imposing things.
			}
		}

		modifier = {
			add = -0.5
			owner = {
				is_industrialist = yes
			}
		}

		modifier = {
			add = -0.5
			owner = {
				has_origin = origin_subterranean
			}
		}
	}
}

d_submerged_ore_veins = {
	category = deposit_cat_minerals

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 480

	resources = {
		category = deposit_blockers_natural
		cost = {
			trigger = {
				owner = {
					NOT = { has_trait = trait_aquatic }
				}
			}
			energy = 800
		}
		cost = {
			trigger = {
				owner = { has_trait = trait_aquatic	}
			}
			minerals = 600
		}
	}

	on_cleared = {
		if = {
			limit = {
				owner = { has_trait = trait_aquatic }
			}
			owner = {
				add_resource = {
					minerals = 1000
				}
			}
		}
		else = {
			owner = {
				add_resource = {
					minerals = 600
				}
			}
		}
	}

	planet_modifier = {
		district_mining_max = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_minerals_produces_add = 1
			planet_colonist_engineering_research_produces_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_trait = trait_aquatic	}
		}
		modifier = {
			planet_max_districts_add = -2
			district_mining_max = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			owner = { has_origin = origin_ocean_paradise }
			is_homeworld = yes
		}
		modifier = {
			district_mining_max = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_mining_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	potential = {
		OR = {
			is_planet_class = pc_ocean
			is_planet_class = pc_continental
			is_planet_class = pc_gaia
		}
	}

	drop_weight = {
		weight = @high
		modifier = {
			factor = 2
			is_planet_class = pc_ocean
		}
	}

	ai_weight = {
		weight = @keep

		modifier = {
			add = 1
			owner = { has_trait = trait_aquatic }
		}

		modifier = {
			add = -0.75
			colony_type = col_mining
		}
	}
}

###################
##### FOOD	#####
###################
d_lichen_fields = {
	category = deposit_cat_food

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 90

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 300
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_farming_max = 1
		planet_farmers_unity_produces_add = 1
		biological_pop_happiness = -0.1
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_farming_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_food_produces_add = 2
			planet_colonist_unity_produces_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_trait = trait_lithoid }
		}
		modifier = {
			habitability_ceil_add = -0.1
		}
	}

	drop_weight = {
		weight = @blocker_high
		modifier = {
			factor = 1.5
			is_planet_class = pc_nuked
		}
		modifier = {
			factor = 4
			OR = {
				is_cold = yes
			}
		}
		modifier = {
			factor = 0.5
			OR = {
				is_planet_class = pc_arid
				is_planet_class = pc_savannah
			}
		}
		modifier = {
			factor = 0.25
			is_planet_class = pc_continental
		}
		modifier = {
			factor = 0
			OR = {
				is_planet_class = pc_ocean
				is_planet_class = pc_tropical
				is_planet_class = pc_desert
			}
		}
	}

	ai_weight = {
		weight = @clear

		modifier = {
			add = -0.5
			owner = {
				OR = {
					has_ai_personality = slaving_despots	# You can still live on lichen.
					has_ai_personality = decadent_hierarchy
					has_ai_personality = spiritual_seekers	# Mana
					has_ai_personality = honorbound_warriors	# Survival
				}
			}
		}

		modifier = {
			add = -0.25
			colony_type = col_farming
			is_cold = yes	# Needs to be both, otherwise this feature really isn't worth it
		}

		modifier = {
			add = -0.5
			owner = {
				has_trait = trait_plantoid_budding
			}
		}

		modifier = {
			add = 0.75
			OR = {
				colony_type = col_bureau
				colony_type = col_bureau_hive
				colony_type = col_bureau_hive
				colony_type = col_bureau_machine
			}
		}

		modifier = {
			add = -1000
			owner = { has_trait = trait_lithoid }
		}
	}
}

d_bountiful_plains = {
	icon = d_fertile_lands
	category = deposit_cat_food
	
	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 180

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 250
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_farming_max = 2
		pop_happiness = 0.05
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_food_produces_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_farming_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	drop_weight = {
		weight = @low
		modifier = {
			factor = 4
			is_planet_class = pc_gaia
		}
		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_continental
				is_planet_class = pc_savannah
			}
		}
		modifier = {
			factor = 0.5
			OR = {
				is_planet_class = pc_tundra
				is_planet_class = pc_arid
			}
		}
		modifier = {
			factor = 0
			OR = {
				is_planet_class = pc_arctic
				is_planet_class = pc_alpine
				is_planet_class = pc_desert
				is_planet_class = pc_ocean
				is_planet_class = pc_tropical
				is_planet_class = pc_nuked
			}
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -1
			colony_type = col_farming
		}

		modifier = {
			add = -0.75
			owner = {
				OR = {
					has_ai_personality = spiritual_seekers	# Preach, farmer
					has_ai_personality = evangelising_zealots
					has_ai_personality = peaceful_traders	# Barter economy
					has_ai_personality = decadent_hierarchy
					has_ai_personality = harmonious_hierarchy
					has_ai_personality = xenophobic_isolationists
					has_ai_personality = fanatic_befrienders
					has_ai_personality = fanatic_purifiers
				}
			}
		}

		modifier = {
			add = -1000
			owner = { has_civic = civic_agrarian_idyll }
		}
	}
}

d_rugged_woods = {
	category = deposit_cat_food

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 720

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 800
		}
		cost = {
			trigger = {
				owner = { has_technology = tech_mountain_range }
			}
			energy = -300
		}
	}

	on_cleared = {
		if = {
			limit = {
				NOT = {
					owner = {
						OR = {
							has_technology = tech_mountain_range
							has_technology = tech_terrestrial_sculpting
						}
					}
				}
			}
			owner = {
				add_resource = {
					minerals = 200
					food = 100
				}
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -2
		planet_jobs_food_produces_mult = 0.05
		planet_amenities_add = 5
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_farming_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_food_produces_add = 2
		}
	}

	drop_weight = {
		weight = @med

		modifier = {
			factor = 4
			planet_size > 20
		}
		modifier = {
			factor = 2
			planet_size > 15
		}
		modifier = {
			factor = 0.5
			planet_size < 13
		}

		modifier = {
			factor = 5
			is_planet_class = pc_continental
		}
		modifier = {
			factor = 2.5
			OR = {
				is_planet_class = pc_gaia
				is_planet_class = pc_tropical
				is_planet_class = pc_tundra
				is_planet_class = pc_alpine
			}
		}
		modifier = {
			factor = 0.1
			is_planet_class = pc_nuked
		}
		modifier = {
			factor = 0
			OR = {
				is_planet_class = pc_arctic
				is_planet_class = pc_desert
				is_planet_class = pc_savannah
				is_planet_class = pc_arid
			}
		}

		modifier = {
			factor = 5
			has_planet_modifier = pm_lush
		}

		modifier = {
			add = 10
			has_hill_feature = yes
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.5
			colony_type = col_farming
		}

		modifier = {
			add = -0.5
			owner = {
				has_ai_personality = spiritual_seekers
				has_ai_personality = erudite_explorers
				has_ai_personality = federation_builders
				has_ai_personality = migrating_flock
				has_ai_personality = harmonious_hierarchy
				has_ai_personality = hive_mind
			}
		}

		modifier = {
			add = 0.5
			owner = {
				OR = {
					has_ai_personality = ruthless_capitalists
					has_ai_personality = machine_intelligence
					has_ai_personality = exterminators
					has_ai_personality = devouring_swarm
				}
			}
		}
	}
}

d_green_hills = {
	category = deposit_cat_food

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 720

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 600
		}
		cost = {
			trigger = {
				owner = {
					OR = {
						has_technology = tech_mountain_range
						has_technology = tech_terrestrial_sculpting
					}
				}
			}
			energy = -350
		}
	}

	planet_modifier = {
		planet_max_districts_add = -2
		district_farming_max = 1
		planet_amenities_mult = 0.1
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_farming_max = 1
		mult = value:district_amount_mastery_of_nature
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_food_produces_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_civic = civic_agrarian_idyll
			}
		}
		modifier = {
			district_farming_max = 1
		}
	}

	drop_weight = {
		weight = @med
		modifier = {
			factor = 5
			is_planet_class = pc_gaia
		}
		modifier = {
			factor = 2
			is_wet = yes
		}
		modifier = {
			factor = 0.25
			is_planet_class = pc_tropical
		}
		modifier = {
			factor = 0
			OR = {
				is_planet_class = pc_arid
				is_planet_class = pc_desert
				is_planet_class = pc_arctic
				is_planet_class = pc_tundra
				is_planet_class = pc_nuked
			}
		}

		modifier = {
			factor = 4
			has_hill_feature = yes
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -1000
			owner = { has_civic = civic_agrarian_idyll }
		}

		modifier = {
			add = -0.5
			owner = {
				OR = {
					has_ai_personality = spiritual_seekers	# Wandering monks
					has_ai_personality = evangelising_zealots
					has_ai_personality = harmonious_hierarchy	# One with nature
					has_ai_personality = peaceful_traders	# Next village over
					has_ai_personality = migrating_flock	# Easy nesting
					has_ai_personality = hegemonic_imperialists # We just like imposing things
					has_ai_personality = xenophobic_isolationists
				}
			}
		}
	}
}

d_forgiving_tundra = {	
	category = deposit_cat_food

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 90

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 400
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_farming_max = 1
		pop_ethic_spiritualist_attraction_mult = 0.05	# Praise be!
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_farming_max = 1
		mult = value:district_amount_mastery_of_nature
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				OR = {
					has_ethic = ethic_spiritualist
					has_ethic = ethic_fanatic_spiritualist
				}
			}
		}
		modifier = {
			pop_happiness = 0.5
		}
	}

	potential = {
		OR = {
			is_planet_class = pc_continental
			is_planet_class = pc_arctic
			is_planet_class = pc_tundra
			is_planet_class = pc_alpine
			is_planet_class = pc_gaia
			is_planet_class = pc_nuked	# Very rare, so tombs get *very occasional* food districts
		}
	}

	drop_weight = {
		weight = @med

		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_tundra
				#PD Cold Gaia
			}
		}
		modifier = {
			factor = 0.5
			OR = {
				is_planet_class = pc_alpine
				is_planet_class = pc_gaia
			}
		}
		modifier = {
			factor = 0.1
			is_planet_class = pc_nuked
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.5
			colony_type = col_farming
		}
		
		modifier = {
			add = 1000
			owner = { has_ethic = ethic_fanatic_spiritualist }
		}

		modifier = {
			add = 1
			owner = { has_civic = civic_agrarian_idyll }
		}
	}
}

d_boggy_fens = {
	category = deposit_cat_food

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 480

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 1200
			minerals = 400
		}
		cost = {
			trigger = {
				owner = { has_technology = tech_noxious_swamp }
			}
			energy = -400
			minerals = -200
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				engineering_research = 100
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		planet_researchers_society_research_produces_add = 2
		pop_amenities_usage_mult = 0.1
		planet_jobs_food_produces_mult = 0.05
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_farming_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_food_produces_add = 2
			planet_colonist_society_research_produces_add = 2
		}
	}

	potential = {
		is_planet_class = pc_continental
		is_planet_class = pc_tundra
		is_planet_class = pc_alpine
		is_planet_class = pc_ocean
		is_planet_class = pc_tropical
		is_planet_class = pc_gaia
		is_planet_class = pc_nuked	# So tombs get very occasional farming
	}

	drop_weight = {
		weight = @med
		modifier = {
			factor = 4
			is_planet_class = pc_tundra
		}
		modifier = {
			factor = 2
			is_planet_class = pc_ocean
		}
		modifier = {
			factor = 0.5
			is_planet_class = pc_gaia
		}
		modifier = {
			factor = 0.1
			is_planet_class = pc_nuked
		}
	}

	ai_weight = {
		weight = @base

		modifier = {
			add = -0.25
			owner = {
				OR = {
					has_ai_personality = spiritual_seekers	# Swamp Gods
				}
			}
		}

		modifier = {
			add = -1
			colony_type = col_research
		}

		modifier = {
			add = 0.5
			free_amenities < -10	# Only if we're in crisis here. AIs don't need any more help having planetary revolts.
		}
	}
}

d_nutritious_mudland = {
	category = deposit_cat_food

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 90

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 600
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_farming_max = 1
		planet_farmers_unity_produces_add = 1
		biological_pop_happiness = 0.1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_trait = trait_lithoid }
		}
		modifier = {
			habitability_ceil_add = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_farming_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	drop_weight = {
		weight = @blocker_low
		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_tundra
				is_planet_class = pc_desert
			}
		}
		modifier = {
			factor = 0.5
			is_planet_class = pc_gaia
		}
		modifier = {
			factor = 0.1
			is_planet_class = pc_nuked
		}
		modifier = {
			factor = 0
			OR = {
				is_planet_class = pc_tropical
				is_planet_class = pc_ocean
				is_planet_class = pc_alpine
				is_planet_class = pc_arctic
				is_planet_class = pc_gaia
			}
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.5
			owner = {
				OR = {
					has_ai_personality = slaving_despots	# Mudders
					has_ai_personality = spiritual_seekers	# Touching earth
					has_ai_personality = evangelising_zealots	# Proof of faith
					has_ai_personality = honorbound_warriors	# Basic training
				}
			}
		}

		modifier = {
			add = -0.5
			colony_type = col_farming
		}

		modifier = {
			add = 1.5
			owner = { has_civic = civic_agrarian_idyll }
		}

		modifier = {
			add = 1000
			owner = { has_trait = trait_lithoid }
		}
	}
}

d_fungal_caves = {
	category = deposit_cat_food

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	# prerequisites = {
	# 	"tech_deep_sinkhole"
	# }

	# on_cleared = {
	# 	# Add habitable cave?
	# }

	time = 480

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 400
		}
	}

	planet_modifier = {
		district_farming_max = 1
		district_mining_max = 1
		planet_miners_minerals_produces_mult = -0.05
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_food_produces_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_farming_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	drop_weight = {
		weight = @low
		modifier = {
			factor = 0.5
			is_planet_class = pc_nuked
		}
		modifier = {
			factor = 4
			is_cold = yes
		}
		modifier = {
			factor = 2
			is_wet = yes
		}
		modifier = {
			factor = 0.5
			is_dry = yes
		}
	}

	ai_weight = {
		weight = @keep
	}
}

d_lush_jungle = {
	category = deposit_cat_food

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 480

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 1200
		}
		cost = {
			trigger = {
				owner = { has_technology = tech_terrestrial_sculpting }
			}
			energy = -600
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 500
				consumer_goods = 50
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -2
		planet_jobs_food_produces_mult = 0.1
		planet_researchers_society_research_produces_add = 3
		planet_researchers_physics_research_produces_add = 3
		planet_researchers_engineering_research_produces_add = 3
		planet_amenities_add = 5
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_food_produces_add = 2
			planet_colonist_society_research_produces_add = 3
		}
	}

	potential = {
		is_wet = yes
	}

	drop_weight = {
		weight = @very_low
		modifier = {
			factor = 4
			OR = {
				is_planet_class = pc_tropical
				is_planet_class = pc_gaia
			}
		}
		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_continental
				is_planet_class = pc_ocean
			}
		}

		modifier = {
			factor = 10
			has_planet_modifier = pm_lush
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.5
			owner = {
				OR = {
					has_ai_personality = erudite_explorers
					has_ai_personality = federation_builders
					has_ai_personality = migrating_flock
					has_ai_personality = harmonious_hierarchy
					has_ai_personality = spiritual_seekers
					has_ai_personality = hive_mind
				}
			}
		}

		modifier = {
			add = 0.5
			owner = {
				OR = {
					has_ai_personality = ruthless_capitalists
					has_ai_personality = machine_intelligence
					has_ai_personality = exterminators
					has_ai_personality = devouring_swarm
				}
			}
		}
		
		modifier = {
			add = -0.6
			colony_type = col_research
		}

		modifier = {
			add = -0.25
			colony_type = col_farming
		}

		modifier = {
			add = -0.33
			owner_species = {
				has_trait = trait_plantoid_budding
			}
		}

		modifier = {
			add = 0.33
			owner_species = {
				has_trait = trait_plantoid_phototrophic
			}
		}
	}
}

d_fertile_lands = {
	category = deposit_cat_food

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 90

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 200
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_farming_max = 1
		planet_jobs_food_produces_mult = 0.05
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_food_produces_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_farming_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	drop_weight = {
		weight = @blocker_high
		modifier = {
			factor = 5
			is_planet_class = pc_gaia
		}
		modifier = {
			factor = 2
			is_planet_class = pc_continental
		}
		modifier = {
			factor = 0.5
			OR = {
				is_planet_class = pc_tropical
				is_planet_class = pc_ocean
				is_planet_class = pc_alpine
				is_planet_class = pc_tundra
				is_planet_class = pc_arid
			}
		}
		modifier = {
			factor = 0
			OR = {
				is_planet_class = pc_desert
				is_planet_class = pc_arctic
				is_planet_class = pc_nuked
			}
		}

		modifier = {
			factor = 10
			has_deposit = d_great_river
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -1
			colony_type = col_farming
		}

		modifier = {
			add = -0.75
			owner = {
				OR = {
					has_ai_personality = spiritual_seekers	# Preach, farmer
					has_ai_personality = evangelising_zealots
					has_ai_personality = peaceful_traders	# Barter economy
					has_ai_personality = decadent_hierarchy
					has_ai_personality = harmonious_hierarchy
					has_ai_personality = xenophobic_isolationists
					has_ai_personality = fanatic_befrienders
					has_ai_personality = fanatic_purifiers
				}
			}
		}

		modifier = {
			add = -1000
			owner = { has_civic = civic_agrarian_idyll }
		}
	}
}

d_great_river = {
	category = deposit_cat_food

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 1800

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 2500
		}
	}

	on_cleared = {
		add_deposit = d_hydro_plant
		add_deposit = d_great_river_obstructed
		add_deposit = d_floodplains
		add_deposit = d_floodplains
		add_deposit = d_floodplains
		add_deposit = d_floodplains
	}

	planet_modifier = {
		planet_farmers_food_produces_mult = 0.1
		planet_housing_mult = -0.1
		planet_amenities_add = 10
		trade_value_mult = 0.1
	}

	drop_weight = {
		weight = @low
		modifier = {
			factor = 4
			is_planet_class = pc_gaia
		}
		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_continental
				is_planet_class = pc_savannah
				is_planet_class = pc_tropical
			}
		}
		modifier = {
			factor = 0.66
			is_planet_class = pc_desert
		}
		modifier = {
			factor = 0.33
			OR = {
				is_planet_class = pc_alpine
				is_planet_class = pc_tundra
			}
		}
		modifier = {
			factor = 0
			OR = {
				is_planet_class = pc_arctic
				is_planet_class = pc_arid
				is_planet_class = pc_ocean
				is_planet_class = pc_nuked
			}
		}
	}

	ai_weight = {
		weight = @keep

		modifier = {
			add = -1
			owner = {
				OR = {
					has_ai_personality = ruthless_capitalists
					has_ai_personality = metalhead
					has_ai_personality = exterminators
					has_ai_personality = machine_intelligence
				}
			}
		}
	}
}

d_black_soil = {
	category = deposit_cat_food

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 90

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 400
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 100
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_farming_max = 1
		planet_farmers_food_produces_mult = 0.1
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_farming_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	drop_weight = {
		weight = @med
		modifier = {
			factor = 2
			is_wet = yes
		}
		modifier = {
			factor = 0.5
			OR = {
				is_planet_class = pc_arid
			}
		}
		modifier = {
			factor = 0
			OR = {
				is_planet_class = pc_desert
				is_planet_class = pc_nuked
			}
		}

		modifier = {
			factor = 1.5
			has_volcanic_activity = yes
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -1
			colony_type = col_farming
		}

		modifier = {
			add = -0.75
			owner = {
				OR = {
					has_ai_personality = spiritual_seekers	# Preach, farmer
					has_ai_personality = evangelising_zealots
					has_ai_personality = peaceful_traders	# Easy pickings
					has_ai_personality = decadent_hierarchy
					has_ai_personality = harmonious_hierarchy
					has_ai_personality = xenophobic_isolationists
					has_ai_personality = fanatic_befrienders
					has_ai_personality = fanatic_purifiers
				}
			}
		}

		modifier = {
			add = -1000
			owner = { has_civic = civic_agrarian_idyll }
		}
	}
}

d_teeming_reef = {
	category = deposit_cat_food

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	can_be_cleared = {
		NOT = { has_planet_flag = reef_eco_preserve }
	}

	prerequisites = { "tech_toxic_kelp"	}

	time = 180

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 500
		}
		produces = {
			trigger = {
				has_planet_flag = reef_eco_preserve
			}
			society_research = 2
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		planet_researchers_society_research_produces_add = 2
		planet_amenities_mult = 0.1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_food_produces_add = 2
			planet_colonist_society_research_produces_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			owner = { has_origin = origin_ocean_paradise }
			is_homeworld = yes
		}
		district_farming_max = 1
		mult = value:district_amount_mastery_of_nature

	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_trait = trait_aquatic
			}
			OR = {
				is_homeworld = no
				NOT = { has_planet_flag = lost_colony_homeworld }
			}
		}
		modifier = {
			planet_max_districts_add = 1
			district_farming_max = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { 
				OR = {
					has_civic = civic_anglers
					has_civic = civic_corporate_anglers
				}
			}
		}
		modifier = {
			district_farming_max = 1
		}
	}

	potential = {
		OR = {
			is_planet_class = pc_gaia
			is_planet_class = pc_ocean
			is_planet_class = pc_continental
			is_planet_class = pc_arctic
		}
	}

	drop_weight = {
		weight = @med

		modifier = {
			factor = 4
			OR = {
				is_planet_class = pc_ocean
			}
		}
		modifier = {
			factor = 2
			is_planet_class = pc_continental
		}
		modifier = {
			factor = 0.5
			is_planet_class = pc_arctic
		}
		modifier = {
			factor = 4
			is_planet_class = pc_gaia
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -1
			owner = {
				OR = {
					has_civic = civic_anglers
					has_civic = civic_corporate_anglers
				}
			}
		}

		modifier = {
			add = -1
			owner = { has_trait = trait_aquatic	}
			is_homeworld = yes
		}

		modifier = {
			add = -0.5
			colony_type = col_research
		}
	}
}

d_marvelous_oasis = {
	category = deposit_cat_food

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	prerequisites = {
		"tech_noxious_swamp"
	}

	time = 720

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 800
		}
		produces = {
			trigger = {
				is_dry = yes
			}
			unity = 5
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				engineering_research = 1000
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_farming_max = 1
		planet_amenities_mult = 0.05
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_farming_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_food_produces_add = 2
		}
	}

	drop_weight = {
		weight = @very_low
		modifier = {
			factor = 4
			is_planet_class = pc_gaia
		}
		modifier = {
			factor = 2
			is_planet_class = pc_desert
		}
		modifier = {
			factor = 0
			OR = {
				is_cold = yes
				is_wet = yes
				is_planet_class = pc_nuked
			}
		}

		modifier = {
			factor = 4
			has_deposit = d_searing_desert
		}
	}

	ai_weight = {
		weight = @base

		
		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.5
			colony_type = col_farming
		}
	}
}

d_tropical_island = {
	category = deposit_cat_food

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 720

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 1200
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				food = 200
				minerals = 200
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_farming_max = 1
		planet_amenities_add = 10
		pop_happiness = 0.1
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_farming_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			is_planet_class = pc_ocean
			NOT = { owner = { has_trait = trait_aquatic }}
		}
		modifier = {
			planet_max_districts_add = -2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_trait = trait_aquatic }
		}
		modifier = {
			planet_amenities_add = 1
			district_farming_max = -1
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_food_produces_add = 2
			planet_colonist_society_research_produces_add = 3
		}
	}

	potential = {
		OR = {
			is_planet_class = pc_continental
			is_planet_class = pc_ocean
			is_planet_class = pc_gaia
			is_planet_class = pc_nuked		#There's got to be one safe haven.
		}
	}

	drop_weight = {
		weight = @blocker_low
		modifier = {
			factor = 4
			OR = {
				is_planet_class = pc_ocean
				is_planet_class = pc_gaia
			}
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -1
			exists = owner
			owner = { has_trait = trait_aquatic }
		}

		modifier = {
			add = -0.5
			colony_type = col_farming
		}

		modifier = {
			add = -0.5
			exists = owner
			owner = { has_civic = civic_agrarian_idyll }
		}
	}
}

d_fungal_forest = {
	category = deposit_cat_food

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 720

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 800
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				food = 1000
				minerals = 200
				consumer_goods = 50
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -2
		planet_jobs_food_produces_mult = 0.05
		planet_researchers_society_research_produces_add = 1
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_society_research_produces_add = 2
		}
	}

	drop_weight = {
		weight = @med
		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_tundra
				is_planet_class = pc_alpine
			}
		}
		modifier = {
			factor = 0.5
			is_wet = yes
		}
		modifier = {
			factor = 0.1
			is_planet_class = pc_nuked
		}
		modifier = {
			factor = 0
			is_dry = yes
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.5
			owner = {
				OR = {
					has_ai_personality = erudite_explorers
					has_ai_personality = federation_builders
					has_ai_personality = migrating_flock
					has_ai_personality = harmonious_hierarchy
					has_ai_personality = spiritual_seekers
					has_ai_personality = hive_mind
				}
			}
		}

		modifier = {
			add = 0.5
			owner = {
				OR = {
					has_ai_personality = ruthless_capitalists
					has_ai_personality = machine_intelligence
					has_ai_personality = exterminators
					has_ai_personality = devouring_swarm
				}
			}
		}
		
		modifier = {
			add = -0.6
			colony_type = col_research
		}

		modifier = {
			add = -0.25
			colony_type = col_farming
		}

		modifier = {
			add = -0.33
			owner_species = {
				has_trait = trait_plantoid_budding
			}
		}

		modifier = {
			add = 0.33
			owner_species = {
				has_trait = trait_plantoid_phototrophic
			}
		}
	}
}


###################
##### SPECIAL #####
###################

#	Kind of an experiment in fusing technicians and miners to make this deposit more interesting.
d_betharian_deposit = {			
	category = deposit_cat_rare_blocker

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 720

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 500
			engineering_research = 1000		#This needs to be tested so it doesn't bug out and cause a deficit situation to pop.
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				energy = 2500
				minerals = 1000
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		building_betharian_power_plant_max = 1
		planet_technician_energy_produces_mult = 0.1
		planet_technician_minerals_produces_add = 2
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_physics_research_produces_add = 2
		}
	}

	potential = {
		can_have_habitable_deposits = yes
	}

	drop_weight = {
		weight = @mid_rare
		modifier = {
			factor = 2
			is_planet_class = pc_gaia
		}
		modifier = {
			factor = 0
			solar_system = {
				OR = {
					has_star_flag = empire_home_system
					has_star_flag = sol_system
					has_star_flag = deneb_system
				}
			}
		}
	}

	ai_weight = {
		weight = @keep
	}
}

### Gaia Swaps
#	The Block Mod changes these to spawn everywhere (for more variety), though they are still somewhat special.

d_buzzing_plains = {
	category = deposit_cat_energy_rare

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 90

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 200
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_generator_max = 2
		planet_researchers_physics_research_produces_add = 2
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_generator_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			any_owned_pop = {
				has_job = colonist
			}
		}
		modifier = {
			planet_colonist_energy_produces_add = 2
			planet_colonist_physics_research_produces_add = 1
		}
	}

	drop_weight = {
		weight = @very_low
		
		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_arid
				is_planet_class = pc_savannah
				is_planet_class = pc_continental
				is_planet_class = pc_tundra
				is_planet_class = pc_gaia
			}
		}
		modifier = {
			factor = 0.5
			OR = {
				is_planet_class = pc_tropical
				is_planet_class = pc_desert
			}
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.5
			colony_type = col_generator
		}

		modifier = {
			add = -0.5
			colony_type = col_research
		}

		modifier = {
			add = -0.25
			always = yes
		}

		
	}
}

d_mineral_striations = {
	category = deposit_cat_minerals_rare

	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 360

	resources = {
		category = deposit_blockers_natural
		cost = {
			energy = 500
		}
	}

	on_cleared = {
		owner = {
			add_resource = {
				minerals = 1000
				rare_crystals = 100
			}
		}
	}

	planet_modifier = {
		planet_max_districts_add = -1
		district_mining_max = 1
		planet_miners_minerals_produces_mult = 0.1
		planet_miners_physics_research_produces_add = 1
		planet_researchers_engineering_research_produces_add = 2
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_mining_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_trait = trait_aquatic }
		}
		district_mining_max = -1
		mult = value:district_amount_mastery_of_nature
	}

	drop_weight = {
		weight = @very_low

		modifier = {
			factor = 2
			OR = {
				is_planet_class = pc_tropical
				is_planet_class = pc_ocean
			}
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.5
			colony_type = col_mining
		}

		modifier = {
			add = -0.5
			colony_type = col_research
		}

		modifier = {
			add = -0.25
			always = yes
		}
	}
}

d_natural_farmland = {
	category = deposit_cat_food_rare
	
	is_for_colonizable = yes
	use_for_min_max_adjustments = yes

	should_swap_deposit_on_terraforming = no

	time = 90

	planet_modifier = {
		planet_max_districts_add = -1
		district_farming_max = 1
		planet_farmers_food_produces_mult = 0.1
		planet_researchers_society_research_produces_add = 2
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		district_farming_max = 1
		mult = value:district_amount_mastery_of_nature
	}

	drop_weight = {
		weight = @very_low
		modifier = {
			factor = 0
			is_planet_class = pc_nuked
		}
	}

	ai_weight = {
		weight = @base

		inline_script = tbm_personality_weights
		inline_script = tbm_designation_weights

		modifier = {
			add = -0.5
			colony_type = col_farming
		}

		modifier = {
			add = -0.5
			colony_type = col_research
		}

		modifier = {
			add = -0.25
			always = yes
		}
	}
}